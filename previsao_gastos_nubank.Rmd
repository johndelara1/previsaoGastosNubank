---
title: "Previsão de gastos no nubank"
output: html_document
---

```{r include=FALSE}
setwd("~/git/previsaoGastosNubank")
library(readr)
library(dplyr)
library(knitr)
library(lubridate)
require(randomForest) # Arvores de Decisão
library(caret)        # createDataPartition()
library(quantmod) # cotações das ações e do Ibov
library(Quandl) # Selic BACEN
#library("xlsx")
source("codigos/carregar_varios_arquivos_csv_simultaneamente.R")
```

# Valores Positivos
```{r Mostrar Valores Positivos}
contasPositivas <- contasJohn %>% arrange(date) %>% filter(amount > 0)
#kable(contasPositivas)
```

# Valores Negativos
```{r Mostrar Valores Negativos}
#kable(contasJohn %>% arrange(date) %>% filter(amount <= 0))
```

# Agrupamento por dias/soma e média dos gastos
```{r Dias por soma e media}
# Verificar pq o trimestre não bate com as datas e depois agrupar por dias novamente, para enviar ao modelo
source("codigos/juntarDiasMesesTrimestresDeGastos.R")
DiariaMensalETrimestral
write.csv(DiariaMensalETrimestral, "Nubank.csv")
base = DiariaMensalETrimestral
```
# Aplicar modelo Random Forest com tecnicas
```{r}
source("modelos/modeloRandonForest.R")
rf_model_sales
```


# Normalizar as variaveis preditoras numericas
```{r Normalizar}
base = DiariaMensalETrimestral
cols <- c(names(base))
cols <- cols[-1]
cols <- cols[-1]
base$month = as.factor(base$month)
base$month = as.numeric(base$month)
base$year = as.factor(base$year)
base$year = as.numeric(base$year)
colunas <- cols
str(base)
base[, cols] <- scale(base[, cols])
base
```

# Aplicar modelo Random Forest com normalização
```{r}
source("modelos/modeloRandonForest.R")
rf_model_sales
```



